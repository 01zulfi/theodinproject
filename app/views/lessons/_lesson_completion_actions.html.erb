<% if user_signed_in? %>
  <% if current_user.has_completed?(lesson) %>
    <%= render 'lesson_completions/delete_lesson_completion_form',
        lesson: lesson,
        lesson_completion: LessonCompletion.where(student_id: current_user.id, lesson_id: lesson.id).first
    %>
  <% else %>
    <%= render 'lesson_completions/new_lesson_completion_form', lesson: lesson %>
  <% end %>

<% else %>
  <%= link_to 'Login to track progress',
      login_path,
      title: 'Go to login page',
      class: 'button button--primary' %>
<% end %>
